# Project Brief

## Базис и Надстройка - Симулятор Развития Общества

**Версия:** 1.0
**Дата:** 2026-01-31
**Автор:** Analyst Agent (BMAD Method)

---

## 1. Executive Summary

**Базис и Надстройка** — это исследовательский проект по созданию агентной симуляции развития человеческого общества, основанной на марксистской теории исторического материализма.

### Уникальное Торговое Предложение (USP)

> Единственный симулятор, где **классы возникают** из экономических отношений, а **культура формируется** из условий жизни — не задаваясь программистом, а как **emergent phenomena**.

---

## 2. Problem Statement

### 2.1 Проблема

Существующие симуляторы обществ (Civilization, Crusader Kings, RimWorld) имеют фундаментальный недостаток: **социальные структуры задаются жёстко**, а не возникают естественно.

| Проблема | Последствие |
|----------|-------------|
| Жёсткие классы | Нет понимания, ПОЧЕМУ возникают классы |
| Плоские NPC | Персонажи — статисты, не личности |
| Культура как декор | Верования не связаны с экономикой |
| Детерминизм | Истории не "рассказывают себя сами" |

### 2.2 Решение

Создать **emergent-симуляцию**, где:
- Классы **возникают** из отношений собственности
- Верования **формируются** из экономических условий
- NPC — **автономные агенты** с памятью и целями
- История **генерируется** через причинно-следственные связи

---

## 3. Objectives

### 3.1 Бизнес-Цели

| Цель | Метрика Успеха |
|------|----------------|
| Исследовательская платформа | Публикация результатов |
| Образовательный инструмент | Использование в обучении |
| Open Source вклад | GitHub stars, forks, PRs |

### 3.2 Технические Цели

| Цель | Метрика |
|------|---------|
| Emergent классы | Классы появляются за 50-100 лет |
| Технологический прогресс | Смена эпох каждые 200-500 лет |
| Уникальность NPC | 0% идентичных персонажей |
| Связь базис-надстройка | 100% верований имеют экономический источник |

---

## 4. Scope

### 4.1 In Scope (MVP)

- Ядро симуляции (время, события, конфигурация)
- Мир (карта, климат, сезоны, катаклизмы)
- Экономический базис (ресурсы, производство, технологии, собственность)
- Социальная структура (семьи, демография, emergent классы)
- Культурная надстройка (emergent верования, традиции, нормы)
- NPC как личности (stats, skills, personality, needs, memory, BDI)
- CLI интерфейс

### 4.2 Out of Scope (Future)

- Графический интерфейс (pygame)
- Сохранение/загрузка мира
- Multiplayer
- LLM-интеграция для диалогов
- Моддинг API

### 4.3 Constraints

| Ограничение | Причина |
|-------------|---------|
| Python 3.11+ | Современные фичи языка |
| Без внешних зависимостей (core) | Простота развёртывания |
| Текстовый UI первичен | Фокус на логике |
| Марксистская модель | Философская основа |

---

## 5. Target Audience

### 5.1 Primary Personas

#### Исследователь (Researcher)

> "Хочу понять, как работают emergent-системы в социальном контексте"

- **Потребности:** Наблюдение, логирование, статистика
- **Боли:** Сложность настройки существующих инструментов
- **Ожидания:** Простой запуск, понятные логи

#### Разработчик Игр (Game Dev)

> "Ищу референсы для AI систем NPC"

- **Потребности:** Изучение архитектуры BDI, memory
- **Боли:** Отсутствие open source примеров
- **Ожидания:** Чистый код, документация

### 5.2 Secondary Personas

#### Студент/Преподаватель

> "Хочу визуализировать марксистскую теорию"

- **Потребности:** Демонстрация базис → надстройка
- **Ожидания:** Наглядность процессов

#### Энтузиаст Симуляций

> "Люблю Dwarf Fortress за emergent stories"

- **Потребности:** Наблюдение за развитием историй
- **Ожидания:** "Истории рассказывают себя сами"

---

## 6. Success Criteria

### 6.1 MVP Критерии

| Критерий | Определение Готовности |
|----------|------------------------|
| Базис работает | Производство, технологии, собственность функционируют |
| Классы emergent | Классы появляются из экономики без жёсткого задания |
| Надстройка зависит от базиса | Верования формируются из экономических условий |
| NPC уникальны | Каждый NPC отличается от других |
| Смена поколений | Дети наследуют черты родителей |
| Симуляция стабильна | 1000+ лет без краша |

### 6.2 Quality Metrics

| Метрика | Целевое значение |
|---------|------------------|
| Время обновления (1 час sim) | < 100ms для 100 NPC |
| Потребление памяти | < 500MB для 1000 NPC |
| Test coverage | > 80% |
| Documentation coverage | 100% public API |

---

## 7. Technical Approach

### 7.1 Architecture

```
┌─────────────────────────────────────┐
│         PRESENTATION LAYER          │
│              (CLI UI)               │
├─────────────────────────────────────┤
│         APPLICATION LAYER           │
│     (Simulation Loop, Events)       │
├─────────────────────────────────────┤
│           DOMAIN LAYER              │
│  Economy → Society → Culture → NPC  │
├─────────────────────────────────────┤
│       INFRASTRUCTURE LAYER          │
│      (World, Map, Time, Climate)    │
└─────────────────────────────────────┘
```

### 7.2 Key Design Decisions

| Решение | Обоснование |
|---------|-------------|
| Марксистский порядок обновления | Базис определяет надстройку |
| Event-Driven через EventBus | Слабая связанность |
| BDI для NPC | Автономность поведения |
| Emergent-системы | Философская основа проекта |

### 7.3 Technology Stack

| Компонент | Технология |
|-----------|------------|
| Язык | Python 3.11+ |
| Типизация | typing, dataclasses |
| Архитектура | Event-Driven, BDI |
| Паттерны | Observer, Strategy, Factory |

---

## 8. Research Background

### 8.1 Dwarf Fortress

**Идеи для проекта:**
- Процедурная история с причинно-следственными связями
- "Истории рассказывают себя сами"
- Уникальные биографии персонажей

### 8.2 Generative Agents (Stanford)

**Идеи для проекта:**
- Memory Stream — поток памяти
- Reflection — рефлексия, выводы из опыта
- Planning — планирование на день

### 8.3 BDI Architecture

**Идеи для проекта:**
- Beliefs — убеждения о мире
- Desires — желания и цели
- Intentions — выбранные планы

### 8.4 Marxist Theory

**Идеи для проекта:**
- Производительные силы → Производственные отношения
- Базис определяет надстройку
- Классы возникают из собственности

---

## 9. Risks & Mitigations

| Риск | Вероятность | Влияние | Митигация |
|------|-------------|---------|-----------|
| Производительность | Средняя | Высокое | Оптимизация, batching |
| Непредсказуемость emergent | Высокая | Среднее | Логирование, анализ |
| Сложность баланса | Средняя | Среднее | Пресеты, тесты |
| Scope creep | Высокая | Высокое | Чёткий MVP, итерации |

---

## 10. Timeline (Completed)

| Фаза | Описание | Статус |
|------|----------|--------|
| Phase 1 | Core Infrastructure | Done |
| Phase 2 | World & Economy | Done |
| Phase 3 | Society & Culture | Done |
| Phase 4 | NPC & AI | Done |
| Phase 5 | Integration & CLI | Done |
| Phase 6 | Testing & Docs | In Progress |

---

## 11. Stakeholders

| Роль | Интерес |
|------|---------|
| Разработчик | Создание системы |
| Исследователь | Изучение emergent поведения |
| Пользователь | Наблюдение за симуляцией |
| Сообщество | Open Source развитие |

---

## 12. Open Questions

| Вопрос | Статус |
|--------|--------|
| Какой графический движок? | Pending |
| Нужна ли LLM интеграция? | Pending |
| Формат сохранения мира? | Pending |
| Как визуализировать классы? | Pending |

---

## 13. References

### Теоретические основы
- Marx, K. "Das Kapital" (1867)
- Marx, K. & Engels, F. "The German Ideology" (1846)

### Технические референсы
- Park, J. S., et al. "Generative Agents" (2023)
- Bratman, M. "Intention, Plans, and Practical Reason" (1987)

### Игровые референсы
- Dwarf Fortress (Bay 12 Games)
- Majesty (Cyberlore Studios)
- RimWorld (Ludeon Studios)

---

*Документ создан по методологии [BMAD-METHOD](https://github.com/bmad-code-org/BMAD-METHOD)*
